language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "beatenpath";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)
script:
  - npm test             # test the code
  - npm run build-client # make the bundle

before_deploy:
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: beaten-path # see README
  api_key:
    secure: 'eNSrnme8QthNwvAR44zbIM7BGp16WBSi7Qy479c9VkAS1kPMMPy7ANLchk16OuE2WVki1gIrFGKDrYK0I4M5impolNhi1mM7cVuSzASMBlvFuVlU+pNyeL2MkHcGbfvadj7GFaYR+dhsE8KqI9two7OaR0mxptagPSkgK2c9baY9sOPDGN0cVWLWs2bWs2lwq475E/8N1xwfGmiMAl+ZXinQ/RuUYmSaTvaqSf0JAI6poo5YH9GSMrfaDCFqz7N6GAyCOKrEvCIRdQtQP2NBNgPWqA7WqixbPt2w2uTu4AHzCudEjXf2u+hQD6IPHGhIrGGn7gUtcKwysKT8lC3fpCICKqe6pQyfZViIWJOJUC6hDXW+CZz632P4klQ/kP0VmDnmuiZpMAeWTiMV0wkxPs5SC3Jumrq9ucVKjkl9GIvCw10PSEhFIwH185WPw62TGtry+QtRDcH5NKwpK0vQWjyYew+tQxHyGoRpfdbuqW0MZd1iERgW5zNNSMl4Wqdcuik+0SxkA6lPRChCSLYGHKZvISmsVOYhKIjBzXPURwFAR29whwFOf28yv9VBWPPcaeFTe9C2N0pzgcrh2aEiHsxTnzXTqghuQkrJEjWWjpLuEXqj/JheZdW+4Kz2S3qE3HuLN7snM+ZVAkff7uCakIaIBIs2beCP2QCtHH2/A1w=' # see README
